<?php
date_default_timezone_set('Asia/Ho_Chi_Minh');

function bes4($url) {
    try {
        $response = file_get_contents($url, false, stream_context_create([
            'http' => ['timeout' => 5]
        ]));
        
        if ($response !== false) {
            $doc = new DOMDocument();
            @$doc->loadHTML($response);
            $xpath = new DOMXPath($doc);
            
            $version_tag = $xpath->query("//span[@id='version_keyADB']")->item(0);
            $maintenance_tag = $xpath->query("//span[@id='maintenance_keyADB']")->item(0);
            
            $version = $version_tag ? trim($version_tag->nodeValue) : null;
            $maintenance = $maintenance_tag ? trim($maintenance_tag->nodeValue) : null;
            
            return array($version, $maintenance);
        }
    } catch (Exception $e) {
        return array(null, null);
    }
    return array(null, null);
}

function checkver() {
    $url = 'https://checkserver.hotrommo.com/';
    list($version, $maintenance) = bes4($url);
    if ($maintenance == 'on') {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mTool ƒëang ƒë∆∞·ª£c b·∫£o tr√¨. Vui l√≤ng th·ª≠ l·∫°i sau. \nHo·∫∑c v√†o nh√≥m Tele: \033[1;33mhttps://t.me/+77MuosyD-yk4MGY1\n";
        exit();
    }
    return $version;
}

$current_version = checkver();
if ($current_version) {
    echo "Phi√™n b·∫£n hi·ªán t·∫°i: $current_version\n";
} else {
    echo "Kh√¥ng th·ªÉ l·∫•y th√¥ng tin phi√™n b·∫£n ho·∫∑c tool ƒëang ƒë∆∞·ª£c b·∫£o tr√¨.\n";
    exit();
}
system('clear');
// H√†m hi·ªÉn th·ªã banner

if (!function_exists('banner')) {
    function banner() {
        system('clear');
        $banner = "
        \033[1;33m‚ñà‚ñà      ‚ñà‚ñà‚ïó      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó
        \033[1;35m‚ñà‚ñà‚ïó    ‚ïî‚ñà‚ñà‚ïë      ‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë
        \033[1;36m‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë
        \033[1;37m‚ñà‚ñà‚ïë    ‚ïö‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë
        \033[1;32m‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë         ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
        \033[1;31m‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù         ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n
        \033[1;97mTool By: \033[1;32mTr·ªãnh H∆∞·ªõng            \033[1;97mPhi√™n B·∫£n: \033[1;32m4.0     
        \033[97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m Tool\033[1;31m     : \033[1;97m‚òû \033[1;31mTik - Tok\033[1;33m‚ôî \033[1;97müî´
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m Youtube\033[1;31m  : \033[1;97m‚òû \033[1;36mH∆∞·ªõng Dev - Ki·∫øm Ti·ªÅn Online\033[1;31m‚ôî \033[1;97m‚òú
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m Tik Tok\033[1;31m  : \033[1;33mhttps:\033[1;32m//www.tiktok.com\033[1;31m/m@huongdev27
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m Zalo\033[1;31m     : \033[1;97m‚òû\033[1;31m0\033[1;37m3\033[1;36m2\033[1;35m1\033[1;34m6\033[1;33m6\033[1;33m8\033[1;34m6\033[1;35m3‚òú
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m Telegram\033[1;31m : \033[1;97m‚òû\033[1;32mhttps://t.me/+77MuosyD-yk4MGY1üî´\033[1;97m‚òú
        \033[97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        \033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;91m L∆∞u √Ω\033[1;31m    : \033[1;97m‚òû \033[1;32mTool S·ª≠ D·ª•ng ALL Thi·∫øt B·ªã\033[1;31m‚ôî \033[1;97m‚òú
        \033[97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        ";
        foreach (str_split($banner) as $X) {
            echo $X;
            usleep(1250);
        }
    }
}


banner();
echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m ƒê·ªãa ch·ªâ Ip\033[1;32m  : \033[1;32m‚òû\033[1;31m‚ôî \033[1;32m83.86.8888\033[1;31m‚ôî \033[1;97m‚òú\n";
echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
// In menu l·ª±a ch·ªçn
echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p \033[1;31m1 \033[1;33mƒë·ªÉ v√†o \033[1;34mTool Tiktok\033[1;33m\n"; 
echo "\033[1;31m\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mNh·∫≠p 2 ƒê·ªÉ X√≥a Authorization Hi·ªán T·∫°i'\n";

// V√≤ng l·∫∑p ƒë·ªÉ ch·ªçn l·ª±a ch·ªçn (X·ª≠ l√Ω c·∫£ tr∆∞·ªùng h·ª£p ch·ªçn sai)
while (true) {
    try {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p L·ª±a Ch·ªçn (1 ho·∫∑c 2): ";
        $choose = trim(fgets(STDIN));
        $choose = intval($choose);
        if ($choose != 1 && $choose != 2) {
            echo "\033[1;31m\n‚ùå L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá! H√£y nh·∫≠p l·∫°i.\n";
            continue;
        }
        break;
    } catch (Exception $e) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mSai ƒë·ªãnh d·∫°ng! Vui l√≤ng nh·∫≠p s·ªë.\n";
    }
}

// X√≥a Authorization n·∫øu ch·ªçn 2
if ($choose == 2) {
    $file = "Authorization.txt";
    if (file_exists($file)) {
        if (unlink($file)) {
            echo "\033[1;32m[‚úî] ƒê√£ x√≥a $file!\n";
        } else {
            echo "\033[1;31m[‚úñ] Kh√¥ng th·ªÉ x√≥a $file!\n";
        }
    } else {
        echo "\033[1;33m[!] File $file kh√¥ng t·ªìn t·∫°i!\n";
    }
    echo "\033[1;33müëâ Vui l√≤ng nh·∫≠p l·∫°i th√¥ng tin!\n";
}

// Ki·ªÉm tra v√† t·∫°o file n·∫øu ch∆∞a c√≥
$file = "Authorization.txt";
if (!file_exists($file)) {
    if (file_put_contents($file, "") === false) {
        echo "\033[1;31m[‚úñ] Kh√¥ng th·ªÉ t·∫°o file $file!\n";
        exit(1);
    }
}

// ƒê·ªçc th√¥ng tin t·ª´ file
$author = "";
if (file_exists($file)) {
    $author = file_get_contents($file);
    if ($author === false) {
        echo "\033[1;31m[‚úñ] Kh√¥ng th·ªÉ ƒë·ªçc file $file!\n";
        exit(1);
    }
    $author = trim($author);
}

// Y√™u c·∫ßu nh·∫≠p l·∫°i n·∫øu Authorization tr·ªëng
while (empty($author)) {
    echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
    echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p Authorization: ";
    $author = trim(fgets(STDIN));

    // Ghi v√†o file
    if (file_put_contents($file, $author) === false) {
        echo "\033[1;31m[‚úñ] Kh√¥ng th·ªÉ ghi v√†o file $file!\n";
        exit(1);
    }
}

// Ch·∫°y tool
$headers = [
    'Accept-Language' => 'vi,en-US;q=0.9,en;q=0.8',
    'Referer' => 'https://app.golike.net/',
    'Sec-Ch-Ua' => '"Not A(Brand";v="99", "Google Chrome";v="121", "Chromium";v="121"',
    'Sec-Ch-Ua-Mobile' => '?0',
    'Sec-Ch-Ua-Platform' => "Windows",
    'Sec-Fetch-Dest' => 'empty',
    'Sec-Fetch-Mode' => 'cors',
    'Sec-Fetch-Site' => 'same-site',
    'T' => 'VFZSak1FMTZZM3BOZWtFd1RtYzlQUT09',
    'User-Agent' => 'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Mobile Safari/537.36',
    "Authorization" => $author,
    'Content-Type' => 'application/json;charset=utf-8'
];

echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
echo "\033[1;32müöÄ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! ƒêang v√†o Tool Tiktok...\n";
sleep(1);

// H√†m ch·ªçn t√†i kho·∫£n TikTok
function chonacc() {
    global $headers;
    $json_data = array();
    $response = file_get_contents('https://gateway.golike.net/api/tiktok-account', false, stream_context_create([
        'http' => [
            'method' => 'GET',
            'header' => buildHeaders($headers),
            'content' => json_encode($json_data)
        ]
    ]));
    return json_decode($response, true);
}

// H√†m nh·∫≠n nhi·ªám v·ª•
function nhannv($account_id) {
    global $headers;
    $params = array(
        'account_id' => $account_id,
        'data' => 'null'
    );
    $json_data = array();
    $url = 'https://gateway.golike.net/api/advertising/publishers/tiktok/jobs?' . http_build_query($params);
    $response = file_get_contents($url, false, stream_context_create([
        'http' => [
            'method' => 'GET',
            'header' => buildHeaders($headers),
            'content' => json_encode($json_data)
        ]
    ]));
    return json_decode($response, true);
}

// H√†m ho√†n th√†nh nhi·ªám v·ª•
// ·∫®n t·∫•t c·∫£ l·ªói v√† c·∫£nh b√°o PHP
error_reporting(0);
ini_set('display_errors', 0);

function hoanthanh($ads_id, $account_id) {
    global $headers;
    
    $json_data = array(
        'ads_id' => $ads_id,
        'account_id' => $account_id,
        'async' => true,
        'data' => null
    );

    $context = stream_context_create([
        'http' => [
            'method' => 'POST',
            'header' => buildHeaders($headers),
            'content' => json_encode($json_data),
            'ignore_errors' => true // Kh√¥ng hi·ªÉn th·ªã l·ªói c·ªßa file_get_contents
        ]
    ]);

    $response = @file_get_contents('https://gateway.golike.net/api/advertising/publishers/tiktok/complete-jobs', false, $context);

    if ($response === false) {
        return ['error' => 'Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server!'];
    }

    // L·∫•y m√£ HTTP t·ª´ ph·∫£n h·ªìi
    $http_code = 0;
    if (isset($http_response_header) && preg_match('/HTTP\/\d\.\d\s(\d+)/', $http_response_header[0], $matches)) {
        $http_code = (int)$matches[1];
    }

    // Tr·∫£ v·ªÅ l·ªói n·∫øu m√£ HTTP kh√¥ng ph·∫£i 200
    if ($http_code !== 200) {
        return ['error' => "L·ªói HTTP $http_code"];
    }

    return json_decode($response, true);
}

// H√†m b√°o l·ªói
function baoloi($ads_id, $object_id, $account_id, $loai) {
    global $headers;
    
    $json_data1 = array(
        'description' => 'B√°o c√°o ho√†n th√†nh th·∫•t b·∫°i',
        'users_advertising_id' => $ads_id,
        'type' => 'ads',
        'provider' => 'tiktok',
        'fb_id' => $account_id,
        'error_type' => 6
    );
    $response1 = file_get_contents('https://gateway.golike.net/api/report/send', false, stream_context_create([
        'http' => [
            'method' => 'POST',
            'header' => buildHeaders($headers),
            'content' => json_encode($json_data1)
        ]
    ]));
    
    $json_data = array(
        'ads_id' => $ads_id,
        'object_id' => $object_id,
        'account_id' => $account_id,
        'type' => $loai
    );
    $response = file_get_contents('https://gateway.golike.net/api/advertising/publishers/tiktok/skip-jobs', false, stream_context_create([
        'http' => [
            'method' => 'POST',
            'header' => buildHeaders($headers),
            'content' => json_encode($json_data)
        ]
    ]));
    return json_decode($response, true);
}

// H√†m h·ªó tr·ª£ x√¢y d·ª±ng headers
function buildHeaders($headers) {
    $headerString = "";
    foreach ($headers as $key => $value) {
        $headerString .= "$key: $value\r\n";
    }
    return $headerString;
}

// L·∫•y danh s√°ch t√†i kho·∫£n TikTok
$chontktiktok = chonacc();

// Hi·ªÉn th·ªã danh s√°ch t√†i kho·∫£n
function dsacc() {
    global $chontktiktok;
    while (true) {
        try {
            if ($chontktiktok["status"] != 200) {
                echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mAuthorization ho·∫∑c T sai h√£y nh·∫≠p l·∫°i!!!\n";
                echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
                exit();
            }
            banner();
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m ƒê·ªãa ch·ªâ Ip\033[1;32m  : \033[1;32m‚òû\033[1;31m‚ôî \033[1;32m83.86.8888\033[1;31m‚ôî \033[1;97m‚òú\n";
            echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;33m Danh s√°ch acc Tik Tok : \n";
            echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
            for ($i = 0; $i < count($chontktiktok["data"]); $i++) {
                echo "\033[1;36m[".($i + 1)."] \033[1;36m‚úà \033[1;97mID\033[1;32m„ä™ :\033[1;93m ".$chontktiktok["data"][$i]["unique_username"]." \033[1;97m|\033[1;31m„ä™ :\033[1;32m Ho·∫°t ƒê·ªông\n";
            }
            echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
            break;
        } catch (Exception $e) {
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32m".json_encode($chontktiktok)."\n";
            sleep(10);
        }
    }
}

// Hi·ªÉn th·ªã danh s√°ch t√†i kho·∫£n
dsacc();

// Ch·ªçn t√†i kho·∫£n TikTok
$d = 0;
while (true) {
    echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p \033[1;31mID Acc Tiktok \033[1;32ml√†m vi·ªác: ";
    $idacc = trim(fgets(STDIN));
    for ($i = 0; $i < count($chontktiktok["data"]); $i++) {
        if ($chontktiktok["data"][$i]["unique_username"] == $idacc) {
            $d = 1;
            $account_id = $chontktiktok["data"][$i]["id"];
            break;
        }
    }
    if ($d == 0) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mAcc n√†y ch∆∞a ƒë∆∞·ª£c th√™m v√†o golike or id sai\n";
        continue;
    }
    break;
}

// Nh·∫≠p th·ªùi gian l√†m job
while (true) {
    try {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p th·ªùi gian l√†m job : ";
        $delay = intval(trim(fgets(STDIN)));
        break;
    } catch (Exception $e) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mSai ƒë·ªãnh d·∫°ng!!!\n";
    }
}

// Nh·∫≠n ti·ªÅn l·∫ßn 2 n·∫øu l·∫ßn 1 fail
while (true) {
    try {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠n ti·ªÅn l·∫ßn 2 n·∫øu l·∫ßn 1 fail? (y/n): ";
        $lannhan = trim(fgets(STDIN));
        if ($lannhan != "y" && $lannhan != "n") {
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mNh·∫≠p sai h√£y nh·∫≠p l·∫°i!!!\n";
            continue;
        }
        break;
    } catch (Exception $e) {
        // B·ªè qua
    }
}

// Nh·∫≠p s·ªë job fail ƒë·ªÉ ƒë·ªïi acc TikTok
while (true) {
    try {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mS·ªë job fail ƒë·ªÉ ƒë·ªïi acc TikTok (nh·∫≠p 1 n·∫øu k mu·ªën d·ª´ng) : ";
        $doiacc = intval(trim(fgets(STDIN)));
        break;
    } catch (Exception $e) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mNh·∫≠p v√†o 1 s·ªë!!!\n";
    }
}

// Ch·ªçn ch·∫ø ƒë·ªô l√†m vi·ªác
while (true) {
    try {
        echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p 1 : \033[1;33mCh·ªâ nh·∫≠n nhi·ªám v·ª• Follow\n";
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p 2 : \033[1;33mCh·ªâ nh·∫≠n nhi·ªám v·ª• like\n";
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mNh·∫≠p 12 : \033[1;33mK·∫øt h·ª£p c·∫£ Like v√† Follow\n";
        echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;34mCh·ªçn l·ª±a ch·ªçn: ";
        $chedo = intval(trim(fgets(STDIN)));
        
        if ($chedo == 1 || $chedo == 2 || $chedo == 12) {
            break;
        } else {
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mCh·ªâ ƒë∆∞·ª£c nh·∫≠p 1, 2 ho·∫∑c 12!\n";
        }
    } catch (Exception $e) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mNh·∫≠p v√†o 1 s·ªë!!!\n";
    }
}

// X√°c ƒë·ªãnh lo·∫°i nhi·ªám v·ª•
$lam = array();
if ($chedo == 1) {
    $lam = array("follow");
} elseif ($chedo == 2) {
    $lam = array("like");
} elseif ($chedo == 12) {
    $lam = array("follow", "like");
}

// B·∫Øt ƒë·∫ßu l√†m nhi·ªám v·ª•
$dem = 0;
$tong = 0;
$checkdoiacc = 0;
$checkdoiacc1 = 0;
$dsaccloi = array();
$accloi = "";
banner();
echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m ƒê·ªãa ch·ªâ Ip\033[1;32m  : \033[1;32m‚òû\033[1;31m‚ôî \033[1;32m83.86.8888\033[1;31m‚ôî \033[1;97m‚òú\n";
echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
echo "\033[1;36m|STT\033[1;97m| \033[1;33mTh·ªùi gian ‚îä \033[1;32mStatus | \033[1;31mType Job | \033[1;32mID Acc | \033[1;32mXu |\033[1;33m T·ªïng\n";
echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
while (true) {
    if ($checkdoiacc == $doiacc) {
        dsacc();
        $idacc = readline("\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mJob fail ƒë√£ ƒë·∫°t gi·ªõi h·∫°n n√™n nh·∫≠p id acc kh√°c ƒë·ªÉ ƒë·ªïi: ");
        sleep(2);
        banner();
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m]\033[1;97m ƒê·ªãa ch·ªâ Ip\033[1;32m  : \033[1;32m‚òû\033[1;31m‚ôî \033[1;32m83.86.8888\033[1;31m‚ôî \033[1;97m‚òú\n";
        echo "\033[1;97m‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
        $d = 0;
        for ($i = 0; $i < count($chontktiktok["data"]); $i++) {
            if ($chontktiktok["data"][$i]["unique_username"] == $idacc) {
                $d = 1;
                $account_id = $chontktiktok["data"][$i]["id"];
                break;
            }
        }
        if ($d == 0) {
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;31mAcc ch∆∞a th√™m v√†o Golike ho·∫∑c ID kh√¥ng ƒë√∫ng!\n";
            continue;
        }
        $checkdoiacc = 0;
    }

    echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;35mƒêang T√¨m Nhi·ªám v·ª•:>        \r";
    while (true) {
        try {
            $nhanjob = nhannv($account_id);
            break;
        } catch (Exception $e) {
            // pass
        }
    }

    // Ki·ªÉm tra job tr√πng (so s√°nh v·ªõi job tr∆∞·ªõc ƒë√≥)
    static $previous_job = null;
    if ($previous_job !== null && 
        $previous_job["data"]["link"] === $nhanjob["data"]["link"] && 
        $previous_job["data"]["type"] === $nhanjob["data"]["type"]) {
        echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mJob tr√πng v·ªõi job tr∆∞·ªõc ƒë√≥ - B·ªè qua!        \r";
        sleep(2);
        try {
            baoloi($nhanjob["data"]["id"], $nhanjob["data"]["object_id"], $account_id, $nhanjob["data"]["type"]);
        } catch (Exception $e) {
            // pass
        }
        continue;
    }
    $previous_job = $nhanjob;

    if (isset($nhanjob["status"]) && $nhanjob["status"] == 200) {
        $ads_id = $nhanjob["data"]["id"];
        $link = $nhanjob["data"]["link"];
        $object_id = $nhanjob["data"]["object_id"];
        $loai = $nhanjob["data"]["type"];

        if (!isset($nhanjob["data"]["link"]) || empty($nhanjob["data"]["link"])) {
            static $notified = false; // Bi·∫øn static gi·ªØ gi√° tr·ªã gi·ªØa c√°c l·∫ßn l·∫∑p
            
            if (!$notified) {
                echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mJob die - Kh√¥ng c√≥ link!        \r";
                sleep(2);
                $notified = true; // ƒê√°nh d·∫•u ƒë√£ th√¥ng b√°o
            }
            
            try {
                baoloi($nhanjob["data"]["id"], $nhanjob["data"]["object_id"], $account_id, $nhanjob["data"]["type"]);
            } catch (Exception $e) {
                // pass
            }
            continue;
        }
        if (!in_array($nhanjob["data"]["type"], $lam)) {
            try {
                baoloi($ads_id, $object_id, $account_id, $nhanjob["data"]["type"]);
                echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mƒê√£ b·ªè qua job {$loai}!        \r";
                sleep(1);
                continue;
            } catch (Exception $e) {
                // pass
            }
        }

        if ($loai == "follow") {
            $loainv = "follow";
        } elseif ($loai == "like") {
            $loainv = " like ";
        }

        // Th·ª≠ m·ªü link v√† ki·ªÉm tra c√≥ th√†nh c√¥ng kh√¥ng
        exec("termux-open-url $link", $output, $return_var);
        if ($return_var !== 0) {
            echo "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mKh√¥ng th·ªÉ m·ªü link - Job die!";
            try {
                baoloi($ads_id, $object_id, $account_id, $nhanjob["data"]["type"]);
            } catch (Exception $e) {
                // pass
            }
            continue;
        }

        for ($remaining_time = $delay; $remaining_time >= 0; $remaining_time--) {
            $colors = array(
                "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;37mH\033[1;36mu\033[1;35mo\033[1;32mn\033[1;31mg \033[1;34mD\033[1;33me\033[1;36mv\033[1;36müçâ - Tool\033[1;36m Vip \033[1;31m\033[1;32m",
                "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;34mH\033[1;31mu\033[1;37mo\033[1;36mn\033[1;32mg \033[1;35mD\033[1;37me\033[1;33mv\033[1;32müçâ - Tool\033[1;34m Vip \033[1;31m\033[1;32m",
                "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;31mH\033[1;37mu\033[1;36mo\033[1;33mn\033[1;35mg \033[1;32mD\033[1;34me\033[1;35mv\033[1;37müçâ - Tool\033[1;33m Vip \033[1;31m\033[1;32m",
                "\033[1;97m[\033[1;91m‚ù£\033[1;97m] \033[1;36m‚úà \033[1;32mH\033[1;33mu\033[1;34mo\033[1;35mn\033[1;36mg \033[1;37mD\033[1;36me\033[1;31mv\033[1;34müçâ - Tool\033[1;31m Vip \033[1;31m\033[1;32m",
                "\033[1;97m[\0
